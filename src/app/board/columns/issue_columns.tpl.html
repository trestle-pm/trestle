<div ng-controller="ColumnsCtrl as columnsCtrl" >
  <button class="btn btn-primary backlog"
          ng-click="showBacklog = !showBacklog">
    {{showBacklog ? 'Hide Backlog' : 'Show Backlog'}}
  </button>

  <ul class="issue-columns" >
    <!-- Backlog Column -->
    <li ng-show="showBacklog" class="column"

        ng-style="columnsCtrl.getColumnWidth()"

        ng-controller="IssueColumnCtrl as colCtrl"
        ng-init="colCtrl.init({isBacklog:true})" >

      <h1 class="column-header">
        <span class="column_name">{{colCtrl.columnName}}</span>
        <span class="wip_count">{{colCtrl.issues.length}}</span>
      </h1>

      <a class="btn btn-success"
         ng-href="https://github.com/{{repoModel.owner}}/{{repoModel.repo}}/issues/new"
         target="_blank">Create Issue</a>

      <div class="milestone_selection">
        <select ng-init="msFilterVal='*'"
                ng-model="msFilterVal"
                ng-options="m.value as m.title for m in columnsCtrl.getMilestoneSelectOptions()">
        </select>
      </div>

      <!-- CARDS List -->
      <ul class="column-body"
          tr-issue-sortable="colCtrl.onIssueMoved(issues, issue)">

        <li class="card-wrapper"
             ng-repeat="issue in repoModel.issues | issuesInBacklog | filterMilestones:msFilterVal | globalIssueFilter | orderBy:'config.columnWeight'"
             data-issue-id="{{issue.id}}" >
          <tr-issue-card issue="issue" />
        </li>
      </ul> <!-- end of card list -->
    </li>

    <!-- Kanban Columns -->
    <li ng-repeat="col_label in repoModel.config.columns" class="column"
        ng-style="columnsCtrl.getColumnWidth()"

        ng-controller="IssueColumnCtrl as colCtrl"
        ng-init="colCtrl.init({labelName:col_label})" >

      <h1 class="column-header">
        <span class="column_name">{{colCtrl.columnName}}</span>
        <span ng-class="{
                over_limit: colCtrl.issues.length > repoModel.config.wip_limit
              }"
              class="wip_count">{{colCtrl.issues.length}}</span>
      </h1>

      <!-- CARDS List -->
      <ul class="column-body" tr-issue-sortable="colCtrl.onIssueMoved(issues, issue)" >

        <li class="card-wrapper"
            ng-repeat="issue in repoModel.issues | issuesWithLabel:colCtrl.labelName | globalIssueFilter | orderBy:'config.columnWeight'"
            data-issue-id="{{issue.id}}" >

          <tr-issue-card issue="issue" />

        </li>
      </ul>

      <!-- end of card list -->
    </li>

  </ul>
</div>
